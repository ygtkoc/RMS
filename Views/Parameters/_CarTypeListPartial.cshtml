@model Dastone.Models.CarTypePartialViewModel
@Html.AntiForgeryToken()

<div class="card" style="margin-top: 15px;">
    <div class="card-header">
        <h5 class="card-title">Araç Tipi Listesi</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Adı</th>
                        <th>Açıklama</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model.AracTipiListesi != null && Model.AracTipiListesi.Any())
                    {
                        @foreach (var tanim in Model.AracTipiListesi)
                        {
                            <tr>
                                <td>@tanim.AracTipiID</td>
                                <td>@tanim.AracTipiName</td>
                                <td>@tanim.AracTipiAciklama</td>
                                <td>
                                    <button class="btn btn-sm btn-danger delete-car-type" data-id="@tanim.AracTipiID" data-name="@tanim.AracTipiName">
                                        <i class="ri-delete-bin-line"></i> Sil
                                    </button>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="4" class="text-center">Hiç araç tipi bulunamadı.</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="pagination-info">
                Sayfa @Model.PageNumber / @Model.TotalPages
            </div>
            <nav aria-label="Page navigation for car types">
                <ul class="pagination pagination-sm mb-0">
                    <li class="page-item @(Model.PageNumber <= 1 ? "disabled" : "")">
                        <a class="page-link" href="#" data-page="@(Model.PageNumber - 1)">Önceki</a>
                    </li>
                    @for (int i = 1; i <= Model.TotalPages; i++)
                    {
                        <li class="page-item @(i == Model.PageNumber ? "active" : "")">
                            <a class="page-link" href="#" data-page="@i">@i</a>
                        </li>
                    }
                    <li class="page-item @(Model.PageNumber >= Model.TotalPages ? "disabled" : "")">
                        <a class="page-link" href="#" data-page="@(Model.PageNumber + 1)">Sonraki</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        console.log('_CarTypeListPartial.cshtml loaded');

        // Arama butonu click olayı
        $('#btnSearchAracTipi').off('click').on('click', function () {
            const searchQuery = $('#searchAracTipi').val();
            loadCarTypeList(1, searchQuery);
        });

        // Arama inputu Enter tuşu olayı
        $('#searchAracTipi').off('keypress').on('keypress', function (e) {
            if (e.which == 13) {
                const searchQuery = $(this).val();
                loadCarTypeList(1, searchQuery);
            }
        });

        // Sayfalama click olayı
        $('.pagination a.page-link').off('click').on('click', function (e) {
            e.preventDefault();
            const page = $(this).data('page');
            const searchQuery = $('#searchAracTipi').val() || '';
            if (page) {
                loadCarTypeList(page, searchQuery);
            }
        });
    });
</script>